function EasyS3(o){if(!o.domain||!o.apiKeySecret)throw new Error("Missing options for Easy S3.");this.upload=async function(e){return Promise.all(e.map(async e=>{const t=await(await fetch(o.domain+"/u",{method:"POST",headers:{"Content-Type":"application/json","X-Authorization":"Secret: "+o.apiKeySecret},body:JSON.stringify({fileSize:e.size,fileName:e.name})})).json(),n=new FormData;return n.append("Content-Type",e.type),Object.entries(t.s3.fields).forEach(([e,t])=>{n.append(e,t)}),n.append("file",e),fetch(t.s3.url,{method:"POST",body:n}).then(e=>{if(e.ok)return document.dispatchEvent(new CustomEvent("easy_s3_upload_complete",{detail:t.misc})),t.misc})}))},o.selector&&function(){if(!o.selector)throw new Error("Missing selector for Easy S3.");document.querySelector(o.selector).onchange=async e=>{await this.upload([...e.target.files])}}()}